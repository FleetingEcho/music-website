webpackJsonp([4],{tj2P:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("BO1k"),n=i.n(a),r=i("msXN"),o=i("gyMJ"),l={name:"singer-page",mixins:[r.a],data:function(){return{registerForm:{name:"",sex:"",birth:"",location:"",introduction:""},tableData:[],tempDate:[],multipleSelection:[],centerDialogVisible:!1,editVisible:!1,delVisible:!1,select_word:"",form:{id:"",name:"",sex:"",pic:"",birth:"",location:"",introduction:""},pageSize:5,currentPage:1,idx:-1}},computed:{data:function(){return this.tableData.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}},watch:{select_word:function(){if(""===this.select_word)this.tableData=this.tempDate;else{this.tableData=[];var e=!0,t=!1,i=void 0;try{for(var a,r=n()(this.tempDate);!(e=(a=r.next()).done);e=!0){var o=a.value;o.name.includes(this.select_word)&&this.tableData.push(o)}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}}}},created:function(){this.getData()},methods:{handleCurrentChange:function(e){this.currentPage=e},uploadUrl:function(e){return this.$store.state.HOST+"/singer/avatar/update?id="+e},addsinger:function(){var e=this,t=this.registerForm.birth,i=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),a=new URLSearchParams;a.append("name",this.registerForm.name),a.append("sex",this.registerForm.sex),a.append("pic","/img/singerPic/hhh.jpg"),a.append("birth",i),a.append("location",this.registerForm.location),a.append("introduction",this.registerForm.introduction),o.a.setSinger(a).then(function(t){1===t.code?(e.getData(),e.registerForm={},e.notify("Successfully added","success")):e.notify("Failed to add ","error")}).catch(function(e){console.log(e)}),this.centerDialogVisible=!1},getData:function(){var e=this;this.tableData=[],this.tempDate=[],o.a.getAllSinger().then(function(t){e.tableData=t,e.tempDate=t,e.currentPage=1})},handleEdit:function(e){this.editVisible=!0,this.idx=e.id;var t=e.birth;this.form={id:e.id,name:e.name,sex:e.sex,pic:e.pic,birth:t,location:e.location,introduction:e.introduction}},saveEdit:function(){var e=this,t=new Date(this.form.birth),i=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),a=new URLSearchParams;a.append("id",this.form.id),a.append("name",this.form.name),a.append("sex",this.form.sex),a.append("pic",this.form.pic),a.append("birth",i),a.append("location",this.form.location),a.append("introduction",this.form.introduction),o.a.updateSingerMsg(a).then(function(t){1===t.code?(e.getData(),e.notify("Modified successfully","success")):e.notify("Failed to modify","error")}).catch(function(e){console.log(e)}),this.editVisible=!1},deleteRow:function(){var e=this;o.a.deleteSinger(this.idx).then(function(t){t?(e.getData(),e.notify("Deleted successfully","success")):e.notify("Failed to delete","error")}).catch(function(e){console.log(e)}),this.delVisible=!1},songEdit:function(e,t){this.$router.push({path:"/song",query:{id:e,name:t}})}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table"},[i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",size:"mini"},on:{click:e.delAll}},[e._v("Batch Delete")]),e._v(" "),i("el-input",{staticClass:"handle-input mr10",attrs:{size:"mini",placeholder:"Select keywords"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v("Add singer")])],1),e._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",height:"550px",data:e.data},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),i("el-table-column",{attrs:{label:"Singer image",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"singer-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:e.getUrl(t.row.pic),alt:""}})]),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl(t.row.id),"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[i("el-button",{attrs:{size:"mini"}},[e._v("Update image")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"Singer",width:"120",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"Gender",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v(e._s(e.changeSex(t.row.sex)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Birthday",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v(e._s(e.attachBirth(t.row.birth)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"location",label:"Region",width:"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"Introduction"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("p",{staticStyle:{height:"100px",overflow:"scroll"}},[e._v("\n            "+e._s(t.row.introduction)+"\n          ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Song list management",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.songEdit(t.row.id,t.row.name)}}},[e._v("Song list management")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Operation",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleEdit(t.row)}}},[e._v("Modify")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.row.id)}}},[e._v("Delete")])]}}])})],1),e._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.tableData.length},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Add singer",visible:e.centerDialogVisible,width:"400px",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[i("el-form",{ref:"registerForm",staticClass:"demo-ruleForm",attrs:{model:e.registerForm,"status-icon":"","label-width":"100px"}},[i("el-form-item",{attrs:{prop:"name",label:"Singer",size:"mini"}},[i("el-input",{attrs:{placeholder:"Singer"},model:{value:e.registerForm.name,callback:function(t){e.$set(e.registerForm,"name",t)},expression:"registerForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Gender",size:"mini"}},[i("el-radio-group",{model:{value:e.registerForm.sex,callback:function(t){e.$set(e.registerForm,"sex",t)},expression:"registerForm.sex"}},[i("el-radio",{attrs:{label:0}},[e._v("Female")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("Male")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("Team")]),e._v(" "),i("el-radio",{attrs:{label:3}},[e._v("Unknown")])],1)],1),e._v(" "),i("el-form-item",{attrs:{prop:"location",label:"HomeTown",size:"mini"}},[i("el-input",{attrs:{placeholder:"HomeTown"},model:{value:e.registerForm.location,callback:function(t){e.$set(e.registerForm,"location",t)},expression:"registerForm.location"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"birth",label:"Birthday",size:"mini"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Select a date"},model:{value:e.registerForm.birth,callback:function(t){e.$set(e.registerForm,"birth",t)},expression:"registerForm.birth"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"introduction",label:"Introduction",size:"mini"}},[i("el-input",{attrs:{type:"textarea",placeholder:"Introduction"},model:{value:e.registerForm.introduction,callback:function(t){e.$set(e.registerForm,"introduction",t)},expression:"registerForm.introduction"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addsinger}},[e._v("OK")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Modify",visible:e.editVisible,width:"600px"},on:{"update:visible":function(t){e.editVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"Singer",size:"mini"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Gender",size:"mini"}},[i("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[i("el-radio",{attrs:{label:0}},[e._v("Female")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("Male")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("Team")]),e._v(" "),i("el-radio",{attrs:{label:3}},[e._v("Unknown")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"Birthday",size:"mini"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Select a date"},model:{value:e.form.birth,callback:function(t){e.$set(e.form,"birth",t)},expression:"form.birth"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Region",size:"mini"}},[i("el-input",{model:{value:e.form.location,callback:function(t){e.$set(e.form,"location",t)},expression:"form.location"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Introduction",size:"mini"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.editVisible=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveEdit}},[e._v("OK")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Hint",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[i("div",{staticClass:"del-dialog-cnt",attrs:{align:"center"}},[e._v("\n      Deletion cannot be recovered. Are you sure to delete it?\n    ")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.delVisible=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.deleteRow}},[e._v("OK")])],1)])],1)},staticRenderFns:[]};var c=i("VU/8")(l,s,!1,function(e){i("z9W4")},"data-v-be9ec1a8",null);t.default=c.exports},z9W4:function(e,t){}});
//# sourceMappingURL=4.236211b0e288ad303a15.js.map