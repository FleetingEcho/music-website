webpackJsonp([6],{A82U:function(t,n,s){"use strict";var e=s("BO1k"),a=s.n(e),i=s("Dd8w"),o=s.n(i),c=s("msXN"),r=s("NYxO"),l=s("gyMJ"),u=s("WU9+"),d={name:"comment",mixins:[c.a],props:{playId:Number,type:Number},data:function(){return{commentList:[],userPic:[],userName:[],textarea:"",ZAN:u.a.ZAN}},computed:o()({},Object(r.b)(["id","userId","index","loginIn","avator"])),watch:{id:function(){this.getComment()}},mounted:function(){this.getComment()},methods:{getComment:function(){var t=this;l.a.getAllComment(this.type,this.playId).then(function(n){t.commentList=n;var s=!0,e=!1,i=void 0;try{for(var o,c=a()(n);!(s=(o=c.next()).done);s=!0){var r=o.value;t.getUsers(r.userId)}}catch(t){e=!0,i=t}finally{try{!s&&c.return&&c.return()}finally{if(e)throw i}}}).catch(function(t){console.log(t)})},getUsers:function(t){var n=this;l.a.getUserOfId(t).then(function(t){n.userPic.push(t[0].avator),n.userName.push(t[0].username)}).catch(function(t){console.log(t)})},postComment:function(){var t=this;if(this.loginIn){var n=new URLSearchParams;1===this.type?n.append("songListId",this.playId):0===this.type&&n.append("songId",this.playId),n.append("userId",this.userId),n.append("type",this.type),n.append("content",this.textarea),l.a.setComment(n).then(function(n){1===n.code?(t.textarea="",t.getComment(),t.notify("comment successfully released","success")):t.notify("Fail to release your comment","error")}).catch(function(t){console.log(t)})}else this.notify("Please login first","warning")},postUp:function(t,n,s){var e=this;if(this.loginIn){var a=new URLSearchParams;a.append("id",t),a.append("up",n+1),l.a.setLike(a).then(function(t){1===t.code&&(e.$refs.up[s].children[0].style.color="#2796dd",e.getComment())}).catch(function(t){console.log(t)})}else this.notify("Please login first","warning")}}},m={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",[s("div",{staticClass:"comment"},[s("h2",[s("span",[t._v("Comment")]),t._v(" "),s("span",{staticClass:"part__tit_desc"},[t._v("\n        "+t._s(t.commentList.length)+" comments in total")])]),t._v(" "),s("div",{staticClass:"comment-msg"},[s("el-input",{staticClass:"comment-input",attrs:{type:"textarea",placeholder:"Looking forward to your wonderful comments...",rows:2},model:{value:t.textarea,callback:function(n){t.textarea=n},expression:"textarea"}})],1),t._v(" "),s("el-button",{staticClass:"sub-btn",attrs:{type:"primary"},on:{click:function(n){return t.postComment()}}},[t._v("Comment")])],1),t._v(" "),t._l(t.commentList,function(n,e){return s("ul",{key:e,staticClass:"popular"},[s("li",[s("div",{staticClass:"popular-img"},[s("img",{attrs:{src:t.attachImageUrl(t.userPic[e]),alt:""}})]),t._v(" "),s("div",{staticClass:"popular-msg"},[s("ul",[s("li",{staticClass:"name"},[t._v(t._s(t.userName[e]))]),t._v(" "),s("li",{staticClass:"content"},[t._v(t._s(n.content))]),t._v(" "),s("li",{staticClass:"time"},[t._v(t._s(n.createTime))])])]),t._v(" "),s("div",{ref:"up",refInFor:!0,staticClass:"up",on:{click:function(s){return t.postUp(n.id,n.up,e)}}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":t.ZAN}})]),t._v("\n        "+t._s(n.up)+"\n      ")])])])})],2)},staticRenderFns:[]};var v=s("VU/8")(d,m,!1,function(t){s("UYyX")},"data-v-30cad448",null);n.a=v.exports},UYyX:function(t,n){},ehyk:function(t,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=s("BO1k"),a=s.n(e),i=s("Dd8w"),o=s.n(i),c=s("msXN"),r=s("yDph"),l=s("A82U"),u=s("NYxO"),d=s("gyMJ"),m={name:"song-list-album",mixins:[c.a],components:{AlbumContent:r.a,Comment:l.a},data:function(){return{songLists:[],singers:{},count:0,songListId:"",value3:0,value5:0}},computed:o()({},Object(u.b)(["loginIn","tempList","listOfSongs","userId","avator"])),created:function(){this.songListId=this.tempList.id,this.singers=this.tempList,this.getSongId(),this.getRank(this.songListId)},methods:{getSongId:function(){var t=this;d.a.getListSongOfSongId(this.songListId).then(function(n){var s=!0,e=!1,i=void 0;try{for(var o,c=a()(n);!(s=(o=c.next()).done);s=!0){var r=o.value;t.getSongList(r.songId)}}catch(t){e=!0,i=t}finally{try{!s&&c.return&&c.return()}finally{if(e)throw i}}t.$store.commit("setListOfSongs",t.songLists)}).catch(function(t){console.log(t)})},getSongList:function(t){var n=this;d.a.getSongOfId(t).then(function(t){n.songLists.push(t[0])}).catch(function(t){console.log(t)})},getRank:function(t){var n=this;d.a.getRankOfSongListId(t).then(function(t){n.value5=t/2}).catch(function(t){console.log(t)})},pushValue:function(){var t=this;if(this.loginIn){var n=new URLSearchParams;n.append("songListId",this.songListId),n.append("consumerId",this.userId),n.append("score",2*this.value3),d.a.setRank(n).then(function(n){1===n.code?(t.getRank(t.songListId),t.notify("Rated successfully","success")):t.notify("Fail to rate this song","error")}).catch(function(t){console.log(t)})}else this.value3=null,this.notify("Please login first","warning")}}},v={render:function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"song-list-album"},[s("div",{staticClass:"album-slide"},[s("div",{staticClass:"album-img"},[s("img",{attrs:{src:t.attachImageUrl(t.singers.pic),alt:""}})]),t._v(" "),s("div",{staticClass:"album-info"},[s("h2",[t._v("Introduction")]),t._v(" "),s("span",[t._v("\n        "+t._s(t.singers.introduction)+"\n      ")])])]),t._v(" "),s("div",{staticClass:"album-content"},[s("div",{staticClass:"album-title"},[s("p",[t._v(t._s(t.singers.title))])]),t._v(" "),s("div",{staticClass:"album-score"},[s("div",[s("h3",[t._v("Song rate:")]),t._v(" "),s("div",[s("el-rate",{attrs:{disabled:""},model:{value:t.value5,callback:function(n){t.value5=n},expression:"value5"}})],1)]),t._v(" "),s("span",[t._v(t._s(2*t.value5))]),t._v(" "),s("div",[s("h3",[t._v("Commentï¼š")]),t._v(" "),s("div",{on:{click:function(n){return t.pushValue()}}},[s("el-rate",{attrs:{"show-text":"","allow-half":""},model:{value:t.value3,callback:function(n){t.value3=n},expression:"value3"}})],1)])]),t._v(" "),s("div",{staticClass:"songs-body"},[s("album-content",{attrs:{songList:t.listOfSongs}},[s("template",{slot:"title"},[t._v("Song list")])],2),t._v(" "),s("comment",{attrs:{playId:t.songListId,type:1}})],1)])])},staticRenderFns:[]};var g=s("VU/8")(m,v,!1,function(t){s("l0bx")},"data-v-50a30a1a",null);n.default=g.exports},l0bx:function(t,n){}});
//# sourceMappingURL=6.356ff7d51447763cdf0e.js.map